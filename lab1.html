<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JustAds ‚Äî Maze of Ads</title>
  <meta name="description" content="JustAds: avanza por un laberinto formado por anuncios. Si chocas, visitas el sitio del anuncio. ¬øLlegas al final? Ganas 1000 cr√©ditos intergal√°cticos (ficticios)." />
  <style>
    :root{
      --bg:#0b0f17; --panel:#101726; --ink:#e9eefc; --accent:#6d87ff; --accent2:#17d1ff; --danger:#ff7272; --success:#52ffa8;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:radial-gradient(1200px 700px at 10% 0%,#0e1430 0%,#0b0f17 45%,#060a12 100%);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif}
    a{color:var(--accent)}
    .wrap{max-width:1100px;margin:0 auto;padding:18px}
    header{
      display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:12px;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));
      display:grid;place-items:center;font-weight:900;color:#071023;box-shadow:0 6px 22px rgba(23,209,255,.25), inset 0 0 18px rgba(255,255,255,.15);
    }
    h1{font-size:clamp(18px,3vw,24px);margin:0}
    .controls{display:flex;gap:10px;flex-wrap:wrap}
    .btn{
      appearance:none;border:1px solid #2a3550;background:#121a2e;color:var(--ink);
      padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600;
      box-shadow:0 2px 0 #0a0f1d;transition:transform .06s ease, box-shadow .06s ease, background .2s;
    }
    .btn:hover{background:#162140}
    .btn:active{transform:translateY(1px);box-shadow:0 1px 0 #0a0f1d}
    .grid{
      display:grid;grid-template-columns:1fr;gap:14px;
      grid-template-rows:auto 1fr;
    }
    .panel{
      background:linear-gradient(180deg,#0c1324,#0a111f);
      border:1px solid #1b2540;border-radius:16px;padding:14px;
      box-shadow:0 12px 40px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.02);
    }
    .legend{display:flex;flex-wrap:wrap;gap:16px;align-items:center;font-size:14px}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:6px 8px;border-radius:10px;background:#0f162a;border:1px solid #223055}
    .k{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:#0c1222;border:1px solid #223055;border-bottom-width:3px;padding:2px 6px;border-radius:6px}
    /* Lienzo responsivo */
    .stage-wrap{
      position:relative;aspect-ratio:16/9;width:100%;max-height:68vh;margin-inline:auto;border-radius:16px;overflow:hidden;
      border:1px solid #1b2540;background:radial-gradient(100% 100% at 50% 0%,#0d1427 0%,#0a0f1d 100%);
      box-shadow:0 24px 60px rgba(0,0,0,.5), inset 0 0 40px rgba(109,135,255,.08);
    }
    canvas{position:absolute;inset:0;width:100%;height:100%}
    /* HUD */
    .hud{
      position:absolute;left:12px;top:10px;display:flex;gap:10px;flex-wrap:wrap;z-index:5
    }
    .hud .pill{background:#0f162a;border:1px solid #223055;border-radius:12px;padding:6px 10px;font-size:13px}
    .start{position:absolute;inset:0;display:grid;place-items:center;z-index:6;background:linear-gradient(180deg,rgba(12,19,36,.75),rgba(10,15,29,.75));backdrop-filter:blur(4px)}
    .card{
      background:#0e152b;border:1px solid #223055;border-radius:16px;padding:18px;max-width:520px;
      box-shadow:0 18px 52px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .title{font-size:20px;margin:0 0 4px}
    .muted{opacity:.8}
    .ad-legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{border:1px dashed #2a3550;border-radius:10px;padding:4px 8px;font-size:12px;background:#0c1324}
    /* Controles m√≥viles */
    .touch{
      position:absolute;right:8px;bottom:8px;display:grid;grid-template-columns:60px 60px 60px;grid-template-rows:60px 60px 60px;gap:6px;z-index:7;
      opacity:.9;user-select:none;touch-action:none;
    }
    .pad{background:#0f162a;border:1px solid #223055;border-radius:12px;display:grid;place-items:center;font-weight:800}
    .pad:active{background:#152141}
    .pad.blank{opacity:0;pointer-events:none}
    /* Modal victoria */
    dialog{
      border:none;border-radius:18px;padding:0;max-width:560px;width:calc(100% - 24px);background:#0f162a;color:var(--ink);
      box-shadow:0 28px 80px rgba(0,0,0,.6), inset 0 0 0 1px rgba(255,255,255,.03);
    }
    dialog::backdrop{background:rgba(0,0,0,.55)}
    .win{padding:20px}
    .win h2{margin:0 0 8px}
    .win .ok{margin-top:12px}
    footer{margin:16px 0 6px;opacity:.7;font-size:13px;text-align:center}
    /* Responsive */
    @media (max-width:720px){
      .legend{font-size:13px}
      .touch{display:grid}
    }
    @media (min-width:721px){
      .touch{display:none}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">JA</div>
        <h1>JustAds ‚Äî Laberinto de Anuncios</h1>
      </div>
      <div class="controls">
        <button class="btn" id="btnStart">Reiniciar</button>
        <button class="btn" id="btnGhost">Ghost mode</button>
        <button class="btn" id="btnMute">Silenciar</button>
      </div>
    </header>

    <div class="grid">
      <div class="panel legend">
        <span class="badge">Mover: <span class="k">WASD</span> / <span class="k">‚Üê‚Üë‚Üí‚Üì</span></span>
        <span class="badge">Objetivo: llega a <strong style="color:var(--success)">META</strong></span>
        <span class="badge">Colisi√≥n con AD ‚áí se abre el link</span>
        <span class="badge">Hosting: GitHub Pages (100% est√°tico)</span>
      </div>

      <div class="stage-wrap" id="stage">
        <div class="hud">
          <div class="pill">Vidas: <span id="lives">‚àû</span></div>
          <div class="pill">Choques: <span id="hits">0</span></div>
          <div class="pill">Tiempo: <span id="time">00:00</span></div>
        </div>

        <canvas id="game" width="1600" height="900" aria-label="JustAds Canvas"></canvas>

        <div class="start" id="startOverlay" role="dialog" aria-modal="true">
          <div class="card">
            <h2 class="title">Bienvenido a <strong>JustAds</strong> üöÄ</h2>
            <p class="muted">Avanza por el camino. Si chocas con un bloque-anuncio, se abrir√° el sitio del anunciante en una nueva pesta√±a.</p>
            <div class="ad-legend">
              <span class="chip">Bloques = Ads clicables por colisi√≥n</span>
              <span class="chip">Meta (verde) = premio ficticio üéÅ</span>
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
              <button class="btn" id="play">Jugar</button>
              <button class="btn" id="playGhost" title="Sin colisiones (test dise√±o)">Explorar (Ghost)</button>
            </div>
          </div>
        </div>

        <!-- Controles t√°ctiles -->
        <div class="touch" id="touch">
          <div class="pad blank"></div>
          <div class="pad" data-dir="up">‚ñ≤</div>
          <div class="pad blank"></div>
          <div class="pad" data-dir="left">‚óÄ</div>
          <div class="pad" data-dir="down">‚ñº</div>
          <div class="pad" data-dir="right">‚ñ∂</div>
          <div class="pad blank"></div>
          <div class="pad blank"></div>
          <div class="pad blank"></div>
        </div>
      </div>
    </div>

    <footer>¬© 2025 JustAds ‚Ä¢ Un experimento l√∫dico. ‚Äú$1000‚Äù son ficticios (no canjeables) en el Sistema Intergal√°ctico de Andr√≥meda.</footer>
  </div>

  <dialog id="winModal">
    <div class="win">
      <h2>üèÅ ¬°Meta alcanzada!</h2>
      <p>Felicitaciones: eres acreedor de <strong>USD 1.000 ficticios</strong> para gastar en el <em>Sistema Intergal√°ctico de Andr√≥meda</em> ü™ê‚ú®</p>
      <p class="muted">Tip: puedes editar el layout/ads desde el array <code>ADS</code> en el c√≥digo y publicar directo en GitHub Pages.</p>
      <button class="btn ok" id="closeWin">Cerrar</button>
    </div>
  </dialog>

  <script>
    // ======= Configuraci√≥n del mundo =======
    const VIRTUAL_W = 1600; // ancho base del canvas (16:9)
    const VIRTUAL_H = 900;

    // Anuncios (bloques) con su rect√°ngulo y URL
    // Puedes reemplazar urls por las de tus sponsors/afiliados/etc.
    const ADS = [
      // x, y, w, h en el espacio virtual 1600x900
      {x: 120,  y: 120, w: 300, h: 60,  url: "https://www.mozilla.org", label:"Mozilla"},
      {x: 500,  y: 120, w: 60,  h: 260, url: "https://www.wikipedia.org", label:"Wikipedia"},
      {x: 560,  y: 320, w: 300, h: 60,  url: "https://developer.android.com", label:"Android Dev"},
      {x: 980,  y: 120, w: 320, h: 60,  url: "https://www.python.org", label:"Python"},
      {x: 980,  y: 180, w: 60,  h: 240, url: "https://nodejs.org", label:"Node.js"},
      {x: 1040, y: 360, w: 260, h: 60,  url: "https://www.rust-lang.org", label:"Rust"},
      {x: 240,  y: 420, w: 380, h: 60,  url: "https://www.cloudflare.com", label:"Cloudflare"},
      {x: 240,  y: 480, w: 60,  h: 280, url: "https://vercel.com", label:"Vercel"},
      {x: 300,  y: 700, w: 380, h: 60,  url: "https://supabase.com", label:"Supabase"},
      {x: 760,  y: 540, w: 60,  h: 260, url: "https://www.postgresql.org", label:"Postgres"},
      {x: 820,  y: 540, w: 300, h: 60,  url: "https://ffmpeg.org", label:"FFmpeg"},
      {x: 1180, y: 540, w: 60,  h: 260, url: "https://docker.com", label:"Docker"},
      {x: 1240, y: 740, w: 240, h: 60,  url: "https://git-scm.com", label:"Git"},
      {x: 1480, y: 220, w: 60,  h: 380, url: "https://openjdk.org", label:"OpenJDK"},
      {x: 140,  y: 220, w: 60,  h: 180, url: "https://www.openssl.org", label:"OpenSSL"},

      // barreras para dar forma de laberinto (rectas largas)
      {x: 0,    y: 80,  w: 1600, h: 30, url: "https://chromium.org", label:"Chromium"},
      {x: 0,    y: 860, w: 1600, h: 30, url: "https://www.gnu.org", label:"GNU"},
      {x: 0,    y: 260, w: 800,  h: 30, url: "https://kubernetes.io", label:"Kubernetes"},
      {x: 800,  y: 260, w: 30,   h: 320, url: "https://react.dev", label:"React"},
      {x: 830,  y: 550, w: 770,  h: 30, url: "https://www.sqlite.org", label:"SQLite"},
      {x: 0,    y: 550, w: 600,  h: 30, url: "https://redis.io", label:"Redis"},
      {x: 600,  y: 550, w: 30,   h: 140, url: "https://nginx.org", label:"Nginx"},
      {x: 350,  y: 690, w: 280,  h: 30, url: "https://bun.sh", label:"Bun"},
    ];

    // Punto de inicio y meta
    const START = { x: 40, y: 120 };
    const GOAL  = { x: 1500, y: 780, w: 70, h: 70 };

    // Jugador
    const player = { x: START.x, y: START.y, r: 12, speed: 3.2 };

    let hits = 0, startTime = null, timerInterval = null;
    let ghostMode = false, muted = false;

    // ======= Utilidades =======
    const $ = sel => document.querySelector(sel);
    const ctx = $("#game").getContext("2d");
    const stage = $("#stage");
    const canvas = $("#game");
    const startOverlay = $("#startOverlay");
    const winModal = $("#winModal");

    function reset(runTimer=true){
      player.x = START.x; player.y = START.y;
      hits = 0; $("#hits").textContent = hits;
      if(runTimer){
        startTime = Date.now();
        if(timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(updateTimer, 200);
      }
      draw();
    }

    function updateTimer(){
      if(!startTime) return;
      const ms = Date.now() - startTime;
      const s = Math.floor(ms/1000), m = Math.floor(s/60);
      const s2 = String(s%60).padStart(2,"0");
      $("#time").textContent = `${String(m).padStart(2,"0")}:${s2}`;
    }

    function playBeep(freq=880, dur=0.05, vol=.05){
      if(muted) return;
      try{
        const ac = new (window.AudioContext || window.webkitAudioContext)();
        const o = ac.createOscillator(); const g = ac.createGain();
        o.type = "triangle"; o.frequency.value = freq;
        g.gain.value = vol; o.connect(g); g.connect(ac.destination);
        o.start(); setTimeout(()=>{o.stop(); ac.close()}, dur*1000);
      }catch(e){}
    }

    // Escalado al tama√±o visual del canvas
    function scaleToViewport(){
      const rect = stage.getBoundingClientRect();
      canvas.width = VIRTUAL_W; canvas.height = VIRTUAL_H; // espacio de dibujo virtual
      // CSS ya estira a contenedor, pero mantenemos coordenadas virtuales
    }

    // Dibujo
    function draw(){
      scaleToViewport();
      ctx.clearRect(0,0,VIRTUAL_W,VIRTUAL_H);

      // Fondo con cuadr√≠cula sutil
      ctx.fillStyle = "#0a0f1d";
      ctx.fillRect(0,0,VIRTUAL_W,VIRTUAL_H);
      ctx.strokeStyle = "rgba(109,135,255,.08)";
      ctx.lineWidth = 1;
      for(let x=0;x<VIRTUAL_W;x+=40){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,VIRTUAL_H); ctx.stroke(); }
      for(let y=0;y<VIRTUAL_H;y+=40){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(VIRTUAL_W,y); ctx.stroke(); }

      // META
      ctx.fillStyle = "rgba(82,255,168,.15)";
      ctx.strokeStyle = "#52ffa8";
      ctx.lineWidth = 3;
      ctx.fillRect(GOAL.x,GOAL.y,GOAL.w,GOAL.h);
      ctx.strokeRect(GOAL.x,GOAL.y,GOAL.w,GOAL.h);
      ctx.font = "bold 16px ui-monospace, monospace";
      ctx.fillStyle = "#52ffa8";
      ctx.fillText("META", GOAL.x+10, GOAL.y+40);

      // ADS
      for(const ad of ADS){
        drawAdBlock(ad);
      }

      // jugador
      const grad = ctx.createRadialGradient(player.x-4,player.y-6,2, player.x,player.y,24);
      grad.addColorStop(0,"#6d87ff");
      grad.addColorStop(1,"#17d1ff");
      ctx.fillStyle = grad;
      ctx.beginPath();
      ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
      ctx.fill();
      ctx.lineWidth = 2;
      ctx.strokeStyle = "rgba(255,255,255,.25)";
      ctx.stroke();
    }

    function drawAdBlock(ad){
      // fondo
      ctx.fillStyle = "#121a2e";
      ctx.fillRect(ad.x, ad.y, ad.w, ad.h);
      // borde "publicitario"
      const grad = ctx.createLinearGradient(ad.x, ad.y, ad.x+ad.w, ad.y+ad.h);
      grad.addColorStop(0, "#6d87ff");
      grad.addColorStop(1, "#17d1ff");
      ctx.strokeStyle = grad;
      ctx.lineWidth = 3;
      ctx.strokeRect(ad.x+1.5, ad.y+1.5, ad.w-3, ad.h-3);

      // contenido
      ctx.save();
      ctx.beginPath(); ctx.rect(ad.x, ad.y, ad.w, ad.h); ctx.clip();
      ctx.fillStyle = "rgba(255,255,255,.08)";
      for(let i=0;i<6;i++){
        const rx = ad.x + (i*ad.w/6);
        ctx.fillRect(rx+6, ad.y+6, ad.w/8, ad.h-12);
      }
      ctx.restore();

      // texto ‚ÄúAD‚Äù
      ctx.fillStyle = "rgba(233,238,252,.95)";
      ctx.font = "700 14px ui-sans-serif, system-ui";
      const label = `AD ‚Ä¢ ${ad.label||"Sponsor"}`;
      ctx.fillText(label, ad.x+10, ad.y+22);
    }

    // Movimiento y colisiones
    const keys = new Set();
    function loop(){
      const vel = player.speed;
      let dx=0, dy=0;
      if(keys.has("ArrowUp")||keys.has("KeyW")) dy -= vel;
      if(keys.has("ArrowDown")||keys.has("KeyS")) dy += vel;
      if(keys.has("ArrowLeft")||keys.has("KeyA")) dx -= vel;
      if(keys.has("ArrowRight")||keys.has("KeyD")) dx += vel;

      moveAndCollide(dx, dy);
      draw();
      requestAnimationFrame(loop);
    }

    function moveAndCollide(dx, dy){
      // movimiento continuo + detecci√≥n AABB/ c√≠rculo-rect√°ngulo
      const next = { x: player.x + dx, y: player.y + dy, r: player.r };

      // l√≠mites canvas
      next.x = Math.max(player.r, Math.min(VIRTUAL_W - player.r, next.x));
      next.y = Math.max(player.r, Math.min(VIRTUAL_H - player.r, next.y));

      // meta
      if(rectCircleIntersect(GOAL, next)){
        // victoria
        playBeep(1200, .08, .06);
        if(!winModal.open) winModal.showModal();
        startTime = null; if(timerInterval) clearInterval(timerInterval);
      }

      // colisiones con ads
      if(!ghostMode){
        for(const ad of ADS){
          if(rectCircleIntersect(ad, next)){
            // colisi√≥n => abrir link (una por frame m√°ximo)
            hits++; $("#hits").textContent = hits;
            playBeep(240, .08, .07);
            safeOpen(ad.url);
            // rebote simple: regresar un poco
            next.x = player.x - dx*2;
            next.y = player.y - dy*2;
            break;
          }
        }
      }

      player.x = next.x; player.y = next.y;
    }

    function rectCircleIntersect(rect, circle){
      const closestX = clamp(circle.x, rect.x, rect.x + rect.w);
      const closestY = clamp(circle.y, rect.y, rect.y + rect.h);
      const dx = circle.x - closestX;
      const dy = circle.y - closestY;
      return (dx*dx + dy*dy) <= (circle.r * circle.r);
    }
    const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));

    function safeOpen(url){
      // Abrir en nueva pesta√±a con noopener (anticlickjacking)
      const win = window.open(url, "_blank", "noopener,noreferrer");
      // Si el navegador bloquea el popup, no hacemos nada extra.
    }

    // ======= Input =======
    document.addEventListener("keydown", (e)=>{
      if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(e.key)) e.preventDefault();
      keys.add(e.code);
    });
    document.addEventListener("keyup", (e)=>{ keys.delete(e.code); });

    // Controles t√°ctiles
    function bindTouchPads(){
      const touch = document.getElementById("touch");
      let pressed = null, interval = null;
      touch.addEventListener("pointerdown", (e)=>{
        const btn = e.target.closest(".pad");
        if(!btn || btn.classList.contains("blank")) return;
        pressed = btn.dataset.dir;
        fireDir(pressed);
        interval = setInterval(()=>fireDir(pressed), 60);
      });
      ["pointerup","pointercancel","pointerleave"].forEach(ev=>{
        touch.addEventListener(ev, ()=>{
          pressed = null; if(interval) {clearInterval(interval); interval=null;}
        })
      });
    }
    function fireDir(dir){
      const vel = player.speed * 1.35; // un poco m√°s r√°pido en t√°ctil
      if(dir==="up") moveAndCollide(0,-vel);
      if(dir==="down") moveAndCollide(0, vel);
      if(dir==="left") moveAndCollide(-vel,0);
      if(dir==="right") moveAndCollide( vel,0);
    }

    // ======= UI =======
    $("#btnStart").addEventListener("click", ()=>{
      startOverlay.style.display="grid"; // mostrar overlay
    });
    $("#btnGhost").addEventListener("click", ()=>{
      ghostMode=!ghostMode;
      $("#btnGhost").textContent = ghostMode ? "Ghost mode: ON" : "Ghost mode";
    });
    $("#btnMute").addEventListener("click", ()=>{
      muted = !muted;
      $("#btnMute").textContent = muted ? "Sonido: OFF" : "Silenciar";
    });
    $("#play").addEventListener("click", ()=>{
      ghostMode=false;
      $("#btnGhost").textContent = "Ghost mode";
      $("#startOverlay").style.display="none";
      reset(true);
    });
    $("#playGhost").addEventListener("click", ()=>{
      ghostMode=true;
      $("#btnGhost").textContent = "Ghost mode: ON";
      $("#startOverlay").style.display="none";
      reset(true);
    });
    $("#closeWin").addEventListener("click", ()=>winModal.close());

    // ======= Inicio =======
    bindTouchPads();
    reset(false);
    draw(); requestAnimationFrame(loop);
    startOverlay.style.display="grid"; // empieza con overlay

    // Asegurar que el canvas usa el tama√±o virtual independientemente del CSS
    window.addEventListener("resize", ()=>{ draw(); });

    // ======= Extensiones r√°pidas para ti =======
    // 1) Cambiar dise√±o del laberinto: edita el array ADS (x,y,w,h,label,url).
    // 2) Ajustar velocidad: player.speed.
    // 3) Cambiar tama√±o del jugador: player.r.
    // 4) Mover inicio/meta: START y GOAL.
    // 5) Registrar m√©tricas: dispara fetch() a tu endpoint (si migras a hosting din√°mico).
  </script>
</body>
</html>
